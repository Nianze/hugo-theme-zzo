{{ if $.Param "enableBusuanzi" }}
  <div class="busuanzi">
    
    {{ if .Site.Params.busuanziSiteUV }}
      <div class="busuanzi__item">
        <span class="busuanzi__item--label">
          {{ i18n "counter-site-uv" }}
        </span>
        <span id="busuanzi_value_site_uv" class="busuanzi__item--number">...</span>
      </div>
    {{ end }}

    {{ if .Site.Params.busuanziSitePV }}
      <div class="busuanzi__item">
        <span class="busuanzi__item--label">
          {{ i18n "counter-site-pv" }}
        </span>
        <span id="busuanzi_value_site_pv" class="busuanzi__item--number">...</span>
      </div>
    {{ end }}

  </div>
  
  <!-- Busuanzi status indicator -->
  <script>
    // Show loading status
    setTimeout(function() {
      var uvElem = document.getElementById('busuanzi_value_site_uv');
      var pvElem = document.getElementById('busuanzi_value_site_pv');
      
      if (uvElem && uvElem.textContent === '...') {
        uvElem.textContent = 'Loading...';
      }
      if (pvElem && pvElem.textContent === '...') {
        pvElem.textContent = 'Loading...';
      }
      
      // Check if busuanzi is working after 5 seconds
      setTimeout(function() {
        if (uvElem && (uvElem.textContent === 'Loading...' || uvElem.textContent === '...')) {
          uvElem.textContent = 'N/A';
          uvElem.title = 'Counter service unavailable';
        }
        if (pvElem && (pvElem.textContent === 'Loading...' || pvElem.textContent === '...')) {
          pvElem.textContent = 'N/A';
          pvElem.title = 'Counter service unavailable';
        }
      }, 5000);
    }, 2000);
    
    // Also handle page view counters in the content
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        var pagePvElem = document.getElementById('busuanzi_value_page_pv');
        if (pagePvElem && pagePvElem.textContent === '...') {
          pagePvElem.textContent = 'Loading...';
          
          // Check again after 3 seconds
          setTimeout(function() {
            if (pagePvElem.textContent === 'Loading...') {
              pagePvElem.textContent = 'N/A';
              pagePvElem.title = 'Counter service unavailable';
            }
          }, 3000);
        }
      }, 1000);
    });
  </script>
{{ end }}